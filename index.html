<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>JunJun ‚Äî Dev Profile</title>
  <link rel="stylesheet" href="style.css">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
</head>
<body>

  <!-- Loading Screen with Progress Bar -->
  <div id="loader" aria-hidden="false">
    <div class="loader-box" role="status" aria-live="polite">
      <div class="loader-logo" aria-hidden="true">
        <svg viewBox="0 0 100 100" width="48" height="48" aria-hidden="true">
          <rect x="10" y="10" width="80" height="80" rx="12" fill="#00aaff"/>
          <text x="50" y="62" font-size="38" text-anchor="middle" fill="#0b0f12" font-family="Arial Rounded MT Bold">JJ</text>
        </svg>
      </div>
      <div class="loader-text" id="loaderState">Loading</div>
      <div class="loader-bar" aria-hidden="true">
        <div class="loader-progress" id="loaderProgress"></div>
      </div>
      <div class="loader-percent" id="loaderPercent">0%</div>
    </div>
  </div>

  <!-- Particle Background -->
  <div class="particle-bg" aria-hidden="true"></div>

  <!-- Settings Button -->
  <button class="settings-btn" id="openSettings" aria-haspopup="dialog" aria-controls="settingsModal">‚öôÔ∏è</button>

  <main class="wrap" id="siteContent" aria-hidden="true">

    <header class="profile" role="banner">
      <!-- Banner (flat, themeable) -->
      <div id="profileBanner" class="profile-banner banner-default" aria-hidden="true"></div>

      <!-- Logo centered above avatar -->
      <div class="logo-above-avatar" aria-hidden="true">
        <svg viewBox="0 0 100 100" width="60" height="60" aria-hidden="true">
          <rect x="10" y="10" width="80" height="80" rx="12" fill="#00aaff"/>
          <text x="50" y="62" font-size="38" text-anchor="middle" fill="#0b0f12" font-family="Arial Rounded MT Bold">JJ</text>
        </svg>
      </div>

      <!-- Avatar centered -->
      <div class="avatar" role="img" aria-label="JunJun avatar">JJ</div>

      <!-- Meta centered -->
      <div class="meta">
        <div class="name">JunJun</div>
        <div class="handle">@dev</div>
        <div class="role">Full‚ÄëStack Developer ‚Ä¢ Game Jam Enthusiast</div>
        <p class="bio">I build clean, performant web experiences and small browser games.</p>
        <div class="visitor-stats" id="visitorStats">Visitors: ‚Äî</div>
      </div>
    </header>

    <section class="textbar">
      <div class="label">Explore more fun projects and mini games</div>
      <a class="link" href="game-website.html">MiniGamesHub</a>
    </section>

    <section class="textbar">
      <div class="label">Join my OG Fortnite Discord Server</div>
      <a class="link" href="https://discord.gg/MSweyqbrxR" target="_blank" rel="noopener">My OG Fortnite Discord Server</a>
    </section>

  </main>

  <!-- Settings Modal -->
  <div id="settingsModal" class="settings-modal" role="dialog" aria-modal="true" aria-hidden="true">
    <div class="settings-content" role="document">
      <h2>Appearance</h2>

      <div class="settings-section">
        <h3 class="section-title">Theme</h3>
        <div class="theme-grid" id="themeGrid">
          <button data-theme="light">Light</button>
          <button data-theme="dark">Dark</button>
          <button data-theme="purple">Purple</button>
          <button data-theme="neonBlue">Neon Blue</button>
          <button data-theme="galaxy">Galaxy</button>
          <button data-theme="galaxyPurple">Galaxy Purple</button>
          <button data-theme="sunset">Sunset</button>
          <button data-theme="matrix">Matrix</button>
          <button data-theme="cyberpunk">Cyberpunk</button>
          <button data-theme="midnight">Midnight</button>
        </div>
      </div>

      <hr>

      <div class="settings-section">
        <h3 class="section-title">Banner Style</h3>
        <div class="banner-grid" id="bannerGrid">
          <button data-banner="blueFade">Blue Fade</button>
          <button data-banner="purpleFade">Purple Fade</button>
          <button data-banner="sunset">Sunset</button>
          <button data-banner="neonBlue">Neon Blue</button>
          <button data-banner="galaxy">Galaxy</button>
          <button data-banner="galaxyPurple">Galaxy Purple</button>
          <button data-banner="midnight">Midnight</button>
          <button data-banner="matrix">Matrix</button>
          <button data-banner="cyberpunk">Cyberpunk</button>
          <button data-banner="iceBlue">Ice Blue</button>
          <button data-banner="lava">Lava</button>
          <button data-banner="emerald">Emerald</button>
          <button data-banner="gold">Gold</button>
          <button data-banner="vaporwave">Vaporwave</button>
          <button data-banner="fortniteOG">Fortnite OG</button>
          <button data-banner="techLines">Tech Lines</button>
          <button data-banner="pixelGrid">Pixel Grid</button>
          <button data-banner="neonMesh">Neon Mesh</button>
        </div>
      </div>

      <hr>

      <div class="settings-section">
        <h3 class="section-title">Chaos Clicker</h3>
        <label class="toggle-row">
          <input type="checkbox" id="disableChaosToggle">
          <span>Disable Chaos Clicker</span>
        </label>
        <div style="height:8px"></div>
        <button id="resetChaosBtn" class="reset-chaos">Reset Chaos Count</button>
      </div>

      <div class="settings-actions">
        <button class="close-btn" id="closeSettings">Close</button>
        <button class="reset-btn" id="resetSettings">Reset Appearance</button>
      </div>
    </div>
  </div>

  <!-- Achievements Panel -->
  <div id="achievementsPanel" class="achievements-panel" aria-hidden="true" role="dialog" aria-label="Achievements">
    <div class="achievements-header">
      <strong>Achievements</strong>
      <button id="closeAchievements" class="close-small" aria-label="Close achievements">‚úï</button>
    </div>
    <div class="achievements-list" id="achievementsList" role="list"></div>
  </div>

  <!-- Floating Achievements Button -->
  <div class="achieve-wrapper" aria-hidden="false">
    <button id="openAchievements" class="achieve-btn" aria-label="Open achievements">üèÜ</button>
  </div>

  <!-- Chaos Clicker (floating right middle) -->
  <div class="chaos-wrapper" aria-hidden="false">
    <button id="chaosBtn" class="chaos-btn" aria-label="Activate Chaos Clicker">Chaos Clicker</button>
    <div class="chaos-counter" id="chaosCounter">Chaos Clicker: 0</div>
  </div>

  <script>
    /* Loader logic with progress bar and dynamic state text */
    (function() {
      const loader = document.getElementById('loader');
      const progressEl = document.getElementById('loaderProgress');
      const percentEl = document.getElementById('loaderPercent');
      const stateEl = document.getElementById('loaderState');
      const siteContent = document.getElementById('siteContent');

      let progress = 0;
      const targetDuration = 1800;
      const start = performance.now();

      function step(now) {
        const elapsed = now - start;
        const t = Math.min(1, elapsed / targetDuration);
        const eased = 1 - Math.pow(1 - t, 2);
        progress = Math.floor(eased * 100);
        progressEl.style.width = progress + '%';
        percentEl.textContent = progress + '%';

        if (progress < 30) stateEl.textContent = 'Preparing assets...';
        else if (progress < 70) stateEl.textContent = 'Applying themes...';
        else if (progress < 95) stateEl.textContent = 'Almost ready...';
        else stateEl.textContent = 'Done';

        if (t < 1) {
          requestAnimationFrame(step);
        } else {
          setTimeout(() => {
            loader.style.opacity = '0';
            loader.style.visibility = 'hidden';
            loader.setAttribute('aria-hidden', 'true');
            siteContent.setAttribute('aria-hidden', 'false');
            document.body.classList.add('loaded');
          }, 220);
        }
      }

      requestAnimationFrame(step);
    })();

    /* Theme and Banner selection logic with swatch active state */
    (function() {
      const themeGrid = document.getElementById('themeGrid');
      const bannerGrid = document.getElementById('bannerGrid');
      const settingsModal = document.getElementById('settingsModal');
      const openSettings = document.getElementById('openSettings');
      const closeSettings = document.getElementById('closeSettings');
      const resetSettings = document.getElementById('resetSettings');
      const profileBanner = document.getElementById('profileBanner');

      const savedTheme = localStorage.getItem('siteTheme');
      const savedBanner = localStorage.getItem('siteBanner');

      if (savedTheme) document.body.setAttribute('data-theme', savedTheme);
      if (savedBanner) {
        profileBanner.className = 'profile-banner banner-' + savedBanner;
        const btn = bannerGrid.querySelector('button[data-banner="'+savedBanner+'"]');
        if(btn) btn.classList.add('active');
      } else {
        profileBanner.className = 'profile-banner banner-default';
      }

      if (savedTheme) {
        const tbtn = themeGrid.querySelector('button[data-theme="'+savedTheme+'"]');
        if(tbtn) tbtn.classList.add('active');
      }

      themeGrid.addEventListener('click', (e) => {
        const btn = e.target.closest('button[data-theme]');
        if (!btn) return;
        const theme = btn.getAttribute('data-theme');
        document.body.setAttribute('data-theme', theme);
        localStorage.setItem('siteTheme', theme);
        themeGrid.querySelectorAll('button[data-theme]').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
      });

      bannerGrid.addEventListener('click', (e) => {
        const btn = e.target.closest('button[data-banner]');
        if (!btn) return;
        const banner = btn.getAttribute('data-banner');
        profileBanner.className = 'profile-banner banner-' + banner;
        localStorage.setItem('siteBanner', banner);
        bannerGrid.querySelectorAll('button[data-banner]').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
      });

      openSettings.addEventListener('click', () => {
        settingsModal.style.display = 'flex';
        settingsModal.setAttribute('aria-hidden', 'false');
        const focusable = settingsModal.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])');
        if(focusable.length) focusable[0].focus();
      });
      closeSettings.addEventListener('click', () => {
        settingsModal.style.display = 'none';
        settingsModal.setAttribute('aria-hidden', 'true');
        openSettings.focus();
      });

      resetSettings.addEventListener('click', () => {
        localStorage.removeItem('siteTheme');
        localStorage.removeItem('siteBanner');
        document.body.removeAttribute('data-theme');
        profileBanner.className = 'profile-banner banner-default';
        themeGrid.querySelectorAll('button[data-theme]').forEach(b => b.classList.remove('active'));
        bannerGrid.querySelectorAll('button[data-banner]').forEach(b => b.classList.remove('active'));
      });

      settingsModal.addEventListener('click', (e) => {
        if (e.target === settingsModal) {
          settingsModal.style.display = 'none';
          settingsModal.setAttribute('aria-hidden', 'true');
          openSettings.focus();
        }
      });

      document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape') {
          settingsModal.style.display = 'none';
          settingsModal.setAttribute('aria-hidden', 'true');
          openSettings.focus();
        }
      });
    })();
  </script>

  <!-- Chaos Clicker + Achievements + Visitor Stats Script -->
  <script>
  (function(){
    /* Elements */
    const chaosBtn = document.getElementById('chaosBtn');
    const chaosCounterEl = document.getElementById('chaosCounter');
    const disableToggle = document.getElementById('disableChaosToggle');
    const resetChaosBtn = document.getElementById('resetChaosBtn');
    const achievementsPanel = document.getElementById('achievementsPanel');
    const achievementsList = document.getElementById('achievementsList');
    const openAchievements = document.getElementById('openAchievements');
    const closeAchievements = document.getElementById('closeAchievements');
    const visitorStatsEl = document.getElementById('visitorStats');

    /* Config */
    const ACHIEVEMENTS = [
      { id: 'ach10', label: 'Novice Chaos', threshold: 10, icon: 'üî∞' },
      { id: 'ach25', label: 'Rising Chaos', threshold: 25, icon: 'üî•' },
      { id: 'ach50', label: 'Chaos Veteran', threshold: 50, icon: 'üí•' },
      { id: 'ach100', label: 'Chaos Master', threshold: 100, icon: 'üèÜ' }
    ];

    const KEY_CHAOS = 'chaos_clicker_count';
    const KEY_ACHIEVEMENTS = 'chaos_achievements_unlocked';
    const KEY_VISITOR_LOCAL = 'site_visitors_local';

    /* State */
    let chaosCount = parseInt(localStorage.getItem(KEY_CHAOS) || '0', 10);
    let unlocked = JSON.parse(localStorage.getItem(KEY_ACHIEVEMENTS) || '[]');
    let localVisitorCount = parseInt(localStorage.getItem(KEY_VISITOR_LOCAL) || '0', 10);

    /* Utilities */
    function randomFrom(arr){ return arr[Math.floor(Math.random()*arr.length)]; }

    /* Achievements UI */
    function renderAchievements(){
      achievementsList.innerHTML = '';
      ACHIEVEMENTS.forEach(a => {
        const el = document.createElement('div');
        el.className = 'achievement-badge' + (unlocked.includes(a.id) ? ' unlocked' : '');
        el.setAttribute('data-id', a.id);
        el.innerHTML = `<div style="font-size:20px">${a.icon}</div><div style="font-size:11px;margin-top:6px">${a.label}</div>`;
        achievementsList.appendChild(el);
      });
    }

    function showToast(text){
      const t = document.createElement('div');
      t.className = 'achievement-toast';
      t.textContent = text;
      document.body.appendChild(t);
      requestAnimationFrame(()=> t.classList.add('show'));
      setTimeout(()=> { t.classList.remove('show'); setTimeout(()=> t.remove(), 260); }, 1600);
    }

    function unlockAchievement(id){
      if(unlocked.includes(id)) return;
      unlocked.push(id);
      localStorage.setItem(KEY_ACHIEVEMENTS, JSON.stringify(unlocked));
      renderAchievements();
      const ach = ACHIEVEMENTS.find(x => x.id === id);
      showToast(`Unlocked: ${ach.label} ${ach.icon}`);
    }

    function checkAchievements(){
      ACHIEVEMENTS.forEach(a => {
        if(chaosCount >= a.threshold) unlockAchievement(a.id);
      });
    }

    function updateChaosUI(){
      chaosCounterEl.textContent = 'Chaos Clicker: ' + chaosCount;
    }

    function resetChaos(){
      chaosCount = 0;
      localStorage.setItem(KEY_CHAOS, String(chaosCount));
      updateChaosUI();
    }

    /* Settings controls */
    if(disableToggle){
      disableToggle.checked = !!localStorage.getItem('chaos_disabled');
      disableToggle.addEventListener('change', () => {
        if(disableToggle.checked) localStorage.setItem('chaos_disabled', '1');
        else localStorage.removeItem('chaos_disabled');
      });
    }

    if(resetChaosBtn){
      resetChaosBtn.addEventListener('click', () => {
        resetChaos();
        unlocked = [];
        localStorage.removeItem(KEY_ACHIEVEMENTS);
        renderAchievements();
        showToast('Chaos reset');
      });
    }

    if(openAchievements){
      openAchievements.addEventListener('click', () => {
        achievementsPanel.style.display = 'flex';
        achievementsPanel.setAttribute('aria-hidden', 'false');
      });
    }
    if(closeAchievements){
      closeAchievements.addEventListener('click', () => {
        achievementsPanel.style.display = 'none';
        achievementsPanel.setAttribute('aria-hidden', 'true');
      });
    }

    /* Hook into Chaos Clicker */
    if(chaosBtn){
      chaosBtn.addEventListener('click', () => {
        if(localStorage.getItem('chaos_disabled')) return;
        chaosCount++;
        localStorage.setItem(KEY_CHAOS, String(chaosCount));
        updateChaosUI();
        checkAchievements();
      });
    }

    /* Visitor stats: optimistic local increment + optional server POST /api/visit */
    async function incrementVisitorCount(){
      localVisitorCount++;
      localStorage.setItem(KEY_VISITOR_LOCAL, String(localVisitorCount));
      renderVisitorCount();

      try{
        const resp = await fetch('/api/visit', { method: 'POST' });
        if(resp.ok){
          const data = await resp.json();
          if(data && typeof data.visitors === 'number'){
            visitorStatsEl.textContent = 'Visitors: ' + data.visitors;
            return;
          }
        }
      }catch(e){
        // ignore network errors, keep local fallback
      }
    }

    function renderVisitorCount(){
      visitorStatsEl.textContent = 'Visitors: ' + localVisitorCount;
    }

    /* Init */
    renderAchievements();
    updateChaosUI();
    renderVisitorCount();
    checkAchievements();
    incrementVisitorCount();

    /* Expose small API */
    window.__ChaosPrototype = {
      getChaosCount: () => chaosCount,
      getUnlocked: () => unlocked.slice(),
      resetChaos
    };
  })();
  </script>

</body>
</html>
